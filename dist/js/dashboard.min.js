"use strict";angular.module("app",["ui.bootstrap","ui.router","ngCookies","ngMessages","ngStorage","satellizer","ang-drag-drop","naif.base64","angularMoment","daterangepicker","chart.js","app.common","app.admin","app.auth"]).run(["amMoment",function(o){o.changeLocale("es")}]).constant("APP_CONSTANT",{apiRest:"http://35.184.167.220/rest-sigeslub",tiposUsuario:[{id:"INS",nombre:"Inspector"},{id:"SOP",nombre:"Soporte"},{id:"SUP",nombre:"Supervisor Marco"},{id:"ADM",nombre:"Administrador"},{id:"CLI",nombre:"Supervisor Mina"}],tiposInspeccion:[{id:"IS",nombre:"Inspección SCL"},{id:"MT",nombre:"Monitoreo temperatura"},{id:"MC",nombre:"Eventos"},{id:"IE",nombre:"Inspección engranaje"}],prioridadInspeccion:[{id:"AL",nombre:"Alta"},{id:"NO",nombre:"Normal"},{id:"BA",nombre:"Baja"}],estadosInspeccion:[{id:"P",nombre:"Proceso"},{id:"O",nombre:"Observado"},{id:"F",nombre:"Finalizado"}],estadosHistorialInspeccion:[{id:"INS",nombre:"Inspección"},{id:"REV",nombre:"Revisión"},{id:"APR",nombre:"Aprobado"}]}).config(["$provide","$httpProvider","$authProvider","APP_CONSTANT",function(o,e,n,r){n.loginUrl=r.apiRest+"/login",n.tokenName="token",n.tokenPrefix="satellizer",n.tokenHeader="Authorization",n.tokenType="Bearer",n.storageType="localStorage"}]).config(["ChartJsProvider",function(o){o.setOptions({chartColors:["#FF5252","#FF8A80"],responsive:!0}),o.setOptions("line",{showLines:!0})}]).run(["$rootScope","$state","$stateParams",function(o,e,n){o.$state=e,o.$stateParams=n,o.go=e.go.bind(e),o.$on("$stateChangeStart",function(e,n,r,i,a,t){o.data=n.data,console.log(n.data)})}]);
"use strict";angular.module("app.admin",["ui.router","ngMessages","ui.bootstrap","chart.js"]).config(["$stateProvider","$urlRouterProvider",function(e,t){e.state("admin.secciones",{url:"/secciones",views:{"content@app":{controller:"SeccionesCtrl",templateUrl:"templates/admin/views/secciones/lista.html"}},data:{title:"Secciones",description:"Gestión de secciones"}}).state("admin.nueva-seccion",{url:"/secciones/nuevo",views:{"content@app":{controller:"SeccionesCtrl",templateUrl:"templates/admin/views/secciones/nuevo.html"}},data:{title:"Registrar Sección",description:"Diseñador de nuevas secciones"}}).state("admin.editar-seccion",{url:"/seccion/:id",views:{"content@app":{templateUrl:"templates/admin/views/secciones/editar.html",controller:"SeccionesEditCtrl"}},data:{title:"Edición de secciones",description:"Edición de secciones registradas anteriormente"}}).state("admin.categorias",{url:"/categorias",views:{"content@app":{controller:"CategoriasCtrl",templateUrl:"templates/admin/views/categorias/lista.html"}},data:{title:"Categorías",description:"Gestión de categorías"}}).state("admin.nueva-categoria",{url:"/categoria/nuevo",views:{"content@app":{templateUrl:"templates/admin/views/categorias/nuevo.html",controller:"CategoriasCtrl"}},data:{title:"Registrar Categoría",description:"Gestión de nuevas categorías"}}).state("admin.editar-categoria",{url:"/categoria/:id",views:{"content@app":{templateUrl:"templates/admin/views/categorias/editar.html",controller:"CategoriasEditCtrl"}},data:{title:"Edición de categorías",description:"Edición de categorías registradas anteriormente"}}).state("admin.minas",{url:"/minas",views:{"content@app":{controller:"MinasCtrl",templateUrl:"templates/admin/views/minas/lista.html"}},data:{title:"Minas",description:"Gestión de minas"}}).state("admin.nueva-mina",{url:"/mina/nuevo",views:{"content@app":{templateUrl:"templates/admin/views/minas/nuevo.html",controller:"MinasCtrl"}},data:{title:"Registrar Mina",description:"Gestión de nuevas minas"}}).state("admin.editar-mina",{url:"/mina/:id",views:{"content@app":{templateUrl:"templates/admin/views/minas/editar.html",controller:"MinasEditCtrl"}},data:{title:"Edición de minas",description:"Edición de minas registradas anteriormente"}}).state("admin.superintendencias",{url:"/superintendencias",views:{"content@app":{controller:"SuperintendenciasCtrl",templateUrl:"templates/admin/views/superintendencias/lista.html"}},data:{title:"Superintendencias",description:"Gestión de superintendencias"}}).state("admin.nueva-superintendencia",{url:"/superintendencia/nuevo",views:{"content@app":{templateUrl:"templates/admin/views/superintendencias/nuevo.html",controller:"SuperintendenciasCtrl"}},data:{title:"Registrar Superintendencia",description:"Gestión de nuevas superintendencias"}}).state("admin.editar-superintendencia",{url:"/superintendencia/:id",views:{"content@app":{templateUrl:"templates/admin/views/superintendencias/editar.html",controller:"SuperintendenciasEditCtrl"}},data:{title:"Edición de superintendencias",description:"Edición de superintendencias registradas anteriormente"}}).state("admin.modelos",{url:"/modelos",views:{"content@app":{controller:"ModelosCtrl",templateUrl:"templates/admin/views/modelos/lista.html"}},data:{title:"Modelos",description:"Gestión de modelos"}}).state("admin.nuevo-modelo",{url:"/modelo/nuevo",views:{"content@app":{templateUrl:"templates/admin/views/modelos/nuevo.html",controller:"ModelosCtrl"}},data:{title:"Registrar Modelos",description:"Gestión de nuevos modelos"}}).state("admin.editar-modelo",{url:"/modelo/:id",views:{"content@app":{templateUrl:"templates/admin/views/modelos/editar.html",controller:"ModelosEditCtrl"}},data:{title:"Edición de Modelos",description:"Edición de modelos registrados anteriormente"}}).state("admin.formatos",{url:"/formatos",views:{"content@app":{controller:"FormatosCtrl",templateUrl:"templates/admin/views/formatos/lista.html"}},data:{title:"Formatos",description:"Gestión de formatos"}}).state("admin.nuevo-formato",{url:"/formato/nuevo",views:{"content@app":{templateUrl:"templates/admin/views/formatos/nuevo.html",controller:"FormatosCtrl"}},data:{title:"Registrar Formatos",description:"Gestión de nuevos Formatos"}}).state("admin.editar-formato",{url:"/formato/:id",views:{"content@app":{templateUrl:"templates/admin/views/formatos/editar.html",controller:"FormatosEditCtrl"}},data:{title:"Edición de Formatos",description:"Edición de formatos registrados anteriormente"}}).state("admin.equipos",{url:"/equipos",views:{"content@app":{controller:"EquiposCtrl",templateUrl:"templates/admin/views/equipos/lista.html"}},data:{title:"Equipos",description:"Gestión de equipos"}}).state("admin.nuevo-equipo",{url:"/equipo/nuevo",views:{"content@app":{templateUrl:"templates/admin/views/equipos/nuevo.html",controller:"EquiposCtrl"}},data:{title:"Registrar Equipos",description:"Gestión de nuevos Equipos"}}).state("admin.editar-equipo",{url:"/equipo/:id",views:{"content@app":{templateUrl:"templates/admin/views/equipos/editar.html",controller:"EquiposEditCtrl"}},data:{title:"Edición de equipos",description:"Edición de equipos registradas anteriormente"}}).state("admin.seguimiento-mantpre",{url:"/seguimiento-mantenimiento-preventivo",views:{"content@app":{controller:"MantenimientoPreventivoCtrl",templateUrl:"templates/admin/views/graficos/seguimientoMantPre.html"}},data:{title:"Seguimiento de inspección",description:"Gráfico seguimiento de inspecciónes mantenimiento preventivo."}}).state("admin.seguimiento-correctivo",{url:"/seguimiento-mantenimiento-correctivo",views:{"content@app":{controller:"MantenimientoCorrectivoCtrl",templateUrl:"templates/admin/views/graficos/seguimientoCorrectivo.html"}},data:{title:"Seguimiento de inspección",description:"Gráfico seguimiento de eventos."}}).state("admin.seguimiento-temperatura",{url:"/seguimiento-monitoreo-temperatura",views:{"content@app":{controller:"MonitoreoTemperaturaCtrl",templateUrl:"templates/admin/views/graficos/seguimientoTemperatura.html"}},data:{title:"Seguimiento de inspección",description:"Gráfico seguimiento de inspecciónes monitoreo de temperatura."}}).state("admin.consulta-linea",{url:"/consulta-linea",views:{"content@app":{controller:"ConsultaLineaCtrl",templateUrl:"templates/admin/views/consultalinea/lista.html"}},data:{title:"Consultas en linea",description:"Consulta de las inspecciones"}}).state("admin.editar-inspeccion",{url:"/inspeccion/:id",views:{"content@app":{templateUrl:"templates/admin/views/consultalinea/editar.html",controller:"InspeccionEditCtrl"}},data:{title:"Edición de inspecciones",description:"Edición de inspecciones realizadas en campo"}}).state("admin.usuarios",{url:"/usuarios",views:{"content@app":{controller:"UsuariosCtrl",templateUrl:"templates/admin/views/usuarios/lista.html"}},data:{title:"Usuarios",description:"Gestión de usuarios"}}).state("admin.editar-usuario",{url:"/usuario/:id",views:{"content@app":{templateUrl:"templates/admin/views/usuarios/editar.html",controller:"UsuariosEditCtrl"}},data:{title:"Edición de Usuario",description:"Edición de usuarios registrados anteriormente"}}).state("admin.nuevo-usuario",{url:"/usuarios/nuevo",views:{"content@app":{templateUrl:"templates/admin/views/usuarios/nuevo.html",controller:"UsuariosCtrl"}},data:{title:"Registrar Usuario",description:"Gestión de nuevos usuarios"}}).state("admin",{"abstract":!0,views:{"root@app":{controller:"MasterCtrl",templateUrl:"templates/admin/views/layouts/base.html"}}}).state("admin.principal",{url:"/",views:{"content@app":{controller:"PrincipalCtrl",templateUrl:"templates/admin/views/principal.html"}},data:{title:"Panel",description:"Resumen de actividades"}}),t.otherwise("/")}]);
"use strict";angular.module("app.auth",["ui.router"]).config(["$stateProvider","$urlRouterProvider",function(t,e){function o(t,e,o,r){var l=t.defer();return e.isAuthenticated()?o.path("/"):l.resolve(),l.promise}o.$inject=["$q","$auth","$location","$localStorage"],t.state("auth",{"abstract":!0}).state("auth.login",{url:"/login",views:{"root@app":{controller:"AuthCtrl",templateUrl:"templates/auth/views/login.html"}},resolve:{skipIfLoggedIn:o}}).state("auth.logout",{url:"/logout",views:{"root@app":{controller:"AuthCtrl"}},resolve:{skipIfLoggedIn:o}}),e.otherwise("/login")}]);
"use strict";angular.module("app.common",["ui.router"]).config(["$stateProvider","$urlRouterProvider",function(r,o){}]);
"use strict";angular.module("app.admin").controller("CategoriasCtrl",["$scope","$state","$location","MensajeService","CategoriaFactory",function(a,e,o,t,s){a.form={},a.registrarCategoria=function(){console.log(a.form),s.registrar(a.form,function(a){console.log(a),void 0==a.respuesta?(window.history.back(),t.showInfoMessage("Categoria registrada exitósamente")):"categoria-existe"==a.respuesta&&t.showInfoMessage("Ya existe una categoría con el mismo nombre.")})},a.eliminarCategoria=function(e){var o=window.confirm("¿Seguro que desea eliminar esta categoría?");o&&s.eliminar(e,function(e){"eliminacion-exitosa"==e.respuesta?(t.showInfoMessage("Categoria eliminada exitósamente"),a.listaCategorias()):"categoria-en-uso"==e.respuesta?t.showInfoMessage("Esta categoría tiene modelos asociados. Por lo tanto, no es posible eliminarla."):"categoria-no-existe"==e.respuesta&&t.showInfoMessage("Esta categoria no existe.")})},a.listaCategorias=function(){s.lista(function(e){a.lista=e})},"/categorias"==o.$$url&&(console.log("Cargando lista de categorias"),a.listaCategorias())}]),angular.module("app.admin").controller("CategoriasEditCtrl",["$scope","$state","$stateParams","MensajeService","CategoriaFactory",function(a,e,o,t,s){var i=o.id;a.form={},s.getXId(i,function(e){console.log(e),a.form=e}),a.editarCategoria=function(){console.log(a.form),s.editar(a.form,function(a){"categoria-existe"==a.respuesta?t.showInfoMessage("La categoría ingresada ya existe."):"actualizacion-exitosa"==a.respuesta&&(window.history.back(),t.showInfoMessage("Categoría actualizada exitósamente"))})}}]);
"use strict";angular.module("app.admin").controller("ConsultaLineaCtrl",["$scope","$state","$location","MensajeService","ModeloFactory","MinaFactory","CategoriaFactory","InspeccionFactory","SuperintendenciaFactory","APP_CONSTANT","$localStorage",function(n,e,o,i,a,t,c,s,r,d,l){n.tipoUsuario=l.user.usuario_tipo,n.minaId=l.user.mina_id,console.log("Tipo de usuario : "+n.tipoUsuario),n.form={},n.datePicker={date:{startDate:void 0,endDate:void 0}},n.listaMinas=function(){t.lista(function(e){n.minas=e,n.form.mina=n.minas[0].id,n.listaSuperintendencias(n.form.mina)})},n.listaSuperintendencias=function(e){r.getXMinaId(e,function(e){n.superintendencias=e,n.form.superintendencia=n.superintendencias[0].id})},n.listaTiposInspeccion=function(){n.tipos=d.tiposInspeccion,n.form.tipo=n.tipos[0].id},Date.prototype.yyyymmdd=function(){var n=this.getMonth()+1,e=this.getDate();return[this.getFullYear(),!n[1]&&"/",n,!e[1]&&"/",e].join("")},n.listaConsultaLinea=function(){if(void 0!=n.datePicker.date.startDate||void 0!=n.datePicker.date.endDate){var e={fechaInicial:n.datePicker.date.startDate._d.yyyymmdd(),fechaFinal:n.datePicker.date.endDate._d.yyyymmdd(),tipo:n.form.tipo,superintendenciaId:n.form.superintendencia};s.getConsultaLinea(e,function(e){if(n.inspecciones=[],e.length>0)if("MC"==n.form.tipo)for(var o=0;o<e.length;o++)null!=e[o].inspeccionCerrada&&void 0!=e[o].inspeccionCerrada&&n.inspecciones.push(e[o].inspeccionCerrada),n.inspecciones.push(e[o]);else n.inspecciones=e;else i.showInfoMessage("No se encontraron resultados")})}else i.showInfoMessage("Ingrese un rando de fechas")},n.generarPdf=function(n){s.generarPdf(n)},n.eliminarInspeccion=function(e){var o=confirm("¿Esta seguro de eliminar esta inspección?");1==o&&s.eliminar(e,function(e){console.log(e),"inspeccion-eliminada"==e.result?(i.showInfoMessage("Inspección eliminada correctamente"),n.listaConsultaLinea()):"inspeccion-no-existe"==e.result?i.showInfoMessage("No existe esta inspección"):"usuario-invalido"==e.result&&i.showInfoMessage("No tienes permisos para eliminar esta inspección")})},"/consulta-linea"==o.$$url&&(n.tipoUsuario==d.tiposUsuario[4].id?n.listaSuperintendencias(l.user.mina_id):n.listaMinas(),n.listaTiposInspeccion())}]),angular.module("app.admin").controller("InspeccionEditCtrl",["$scope","$state","$stateParams","MensajeService","InspeccionFactory","EquipoFactory","SeccionFactory","ComponentesFactory","APP_CONSTANT","$uibModal","$localStorage","$q",function(n,e,o,i,a,t,c,s,r,d,l,u){var p=o.id;n.form={},n.indexSeccionActual=void 0,n.prioridades=r.prioridadInspeccion,n.estados=r.estadosInspeccion,n.componentes=[],n.dimension={filas:5,columnas:4},n.seleccinados=[],n.nuevaSeccion={},n.base64Object={},n.tipoUsuario=l.user.usuario_tipo,n.listaSecciones=function(){c.lista(function(e){n.lista=e})},n.listaComponentes=function(){s.lista(function(e){n.componentes=e})},n.getInspeccion=function(){a.getXId(p,function(e){"SOP"==n.tipoUsuario&&n.estados.splice(2,1),n.inspeccion=e,n.form.prioridad=n.inspeccion.prioridad,n.form.estado=n.inspeccion.estado,n.formato=n.inspeccion.hi[0],n.listaSecciones(),n.listaComponentes()})},n.getInspeccion(),n.abrirImagen=function(n){d.open({templateUrl:"imagenPopup.html",controller:"imagenPopupCtrl",resolve:{picture:function(){return n}}})},n.removerSeccion=function(e){var o=confirm("¿Desea quitar esta sección de la inspección?");1==o&&n.formato.contenido.data.splice(e,1)},n.getMostrarImagenAyuda=function(e){return void 0!=n.formato.contenido.data[e].mostrarImagenAyuda?n.formato.contenido.data[e].mostrarImagenAyuda:(console.log("mostrarImagenAyuda == undefined - retorna: ",!1),!1)},n.nuevaFoto=function(e){n.indexSeccionActual=e,$("#fileImage").click()},n.agregarFoto=function(e,o){var i=u.defer(),a=URL.createObjectURL(e);return Jimp.read(a).then(function(o){o.resize(630,355).quality(100).getBase64(e.type,function(o,a){if(o)throw o;var t=Math.round(.75*a.length);n.base64Object.filetype=e.type,n.base64Object.filesize=t,n.base64Object.base64=a,i.resolve(n.base64Object);var c={src:n.base64Object.base64,sub:""};n.formato.contenido.data[n.indexSeccionActual].contenido.data.pictures.push(c)})})["catch"](function(n){return console.log(n)}),i.promise},n.removerFoto=function(e,o){var i=confirm("¿Esta seguro de remover esta foto?");1==i&&n.formato.contenido.data[e].contenido.data.pictures.splice(o,1)},n.actualizarInspeccion=function(){var e=void 0;if(e=n.form.estado==r.estadosInspeccion[0].id||n.form.estado==r.estadosInspeccion[1].id?r.estadosHistorialInspeccion[1].id:r.estadosHistorialInspeccion[2].id,void 0!=e){var o={id:n.inspeccion.id,ordenTrabajo:n.inspeccion.ordenTrabajo,estado:n.form.estado,prioridad:n.form.prioridad,resumenActividad:n.inspeccion.resumenActividad,horometro:n.inspeccion.horometro,aprobadoSoporte:n.inspeccion.aprobadoSoporte,observaciones:n.inspeccion.observaciones,hi:[{contenido:{data:JSON.parse(angular.toJson(n.formato.contenido.data))},estado:e}]};a.editar(o,function(n){"actualizacion-exitosa"==n.respuesta?(window.history.back(),i.showInfoMessage("Inspección actualizada correctamente")):"faltan-datos"==n.respuesta&&i.showInfoMessage("Faltan datos para poder actualizar esta inspección")})}else alert("El estado no ha sido definido.")},n.onDropT=function(e,o,i,a){n.seccion.content[i].content[a].content=o.contenido.data},n.generarTabla=function(){var e={obj:"table",content:[],pictures:[]};n.seccion=e;for(var o=0;o<n.dimension.filas;o++){var i={obj:"row",content:[]};n.seccion.content.push(i);for(var a=0;a<n.dimension.columnas;a++){var t={obj:"column",selected:!1,content:{}};n.seccion.content[o].content.push(t)}}},n.agregarFila=function(){var e={obj:"row",content:[]};n.seccion.content.push(e);for(var o=0;o<n.dimension.columnas;o++){var i={obj:"column",selected:!1,content:{}};n.seccion.content[n.dimension.filas].content.push(i)}n.dimension.filas++},n.agregarColumna=function(){for(var e=0;e<n.dimension.filas;e++){var o={obj:"column",selected:!1,content:{}};n.seccion.content[e].content.push(o)}n.dimension.columnas++},n.eliminarFila=function(){n.dimension.filas>=2&&(n.dimension.filas--,n.seccion.content.splice(n.dimension.filas,1))},n.eliminarColumna=function(){if(n.dimension.columnas>=2){n.dimension.columnas--;for(var e=0;e<n.dimension.filas;e++)n.seccion.content[e].content.splice(n.dimension.columnas,1)}},n.guardarConfiguracion=function(e,o){switch(n.componentes[o].contenido.data.obj){case"input-option":var i={value:e};n.componentes[o].contenido.data.options.push(i),n.componentes[o].contenido.data.value=n.componentes[o].contenido.data.options[0].value;break;default:console.log("Raro")}},n.removerItemOption=function(e,o){n.componentes[e].contenido.data.options.splice(o,1),0==n.componentes[e].contenido.data.options.length&&(n.componentes[e].contenido.data.value="")},n.agregarASeleccion=function(e,o){if(n.seccion.content[e].content[o].content.hasOwnProperty("obj")){for(var i=!1,a=-1,t=0;t<n.seleccinados.length;t++){var c=n.seleccinados[t];if(c.row==e&&c.col==o){i=!0,a=t;break}}i?a>=0&&(n.seccion.content[e].content[o].selected=!1,n.seleccinados.splice(a,1)):(n.seccion.content[e].content[o].selected=!0,n.seleccinados.push({row:e,col:o}))}else console.log("la celda esta vacia")},n.eliminarSeleccionados=function(){for(var e=0;e<n.seleccinados.length;e++){var o=n.seleccinados[e];n.seccion.content[o.row].content[o.col].selected=!1,n.seccion.content[o.row].content[o.col].content={}}n.seleccinados=[]},n.agregarSeccion=function(){var e={nombre:n.nuevaSeccion.nombre,reporteTemperatura:!1,tipo:"CU",contenido:{data:n.seccion},orden:n.formato.contenido.data.length+1};void 0!=n.imagenAyuda&&(e.imagenAyuda=n.imagenAyuda),n.formato.contenido.data.push(e)}}]),angular.module("app.admin").controller("imagenPopupCtrl",["$scope","$uibModalInstance","picture",function(n,e,o){n.picture=o,n.cancel=function(){e.dismiss("cancel")}}]);
"use strict";angular.module("app.admin").controller("DashboardCtrl",["$scope",function(e){e.alerts=[{type:"success",msg:"Thanks for visiting! Feel free to create pull requests to improve the dashboard!"},{type:"danger",msg:"Found a bug? Create an issue with as many details as you can."}],e.addAlert=function(){e.alerts.push({msg:"Another alert!"})},e.closeAlert=function(s){e.alerts.splice(s,1)}}]);
"use strict";angular.module("app.admin").controller("EquiposCtrl",["$scope","$state","$location","MensajeService","EquipoFactory","SuperintendenciaFactory","ModeloFactory","MinaFactory",function(i,o,e,n,s,a,t,r){i.form={},i.registrarEquipo=function(){var o={nombre:i.form.nombre,superintendencia:{id:i.form.superintendencia},modelo:{id:i.form.modelo},diasOptimo:i.form.diasOptimo,diasCritico:i.form.diasCritico};console.log(o),s.registrar(o,function(i){console.log(i),"registro-exitoso"==i.respuesta?(window.history.back(),n.showInfoMessage("Equipo registrado exitósamente")):"equipo-existente"==i.respuesta&&n.showInfoMessage("Este equipo ya está registrado")})},i.eliminarEquipo=function(o){var e=window.confirm("¿Seguro que desea eliminar este equipo?");e&&s.eliminar(o,function(o){"eliminacion-exitosa"==o.respuesta?(n.showInfoMessage("Equipo eliminado exitósamente"),i.listaEquipos()):"equipo-en-uso"==o.respuesta?n.showInfoMessage("Este equipo tiene inspecciones asociadas. Por lo tanto, no es posible eliminarlo."):"equipo-no-existe"==o.respuesta&&n.showInfoMessage("Este equipo no existe")})},i.listaEquipos=function(){s.lista(function(o){console.log(o),i.lista=o})},i.listaEquiposXMina=function(){s.getXMina(i.form.mina,function(o){i.lista=o})},i.listaMinas=function(){r.lista(function(o){console.log(o),i.minas=o,i.form.mina=i.minas[0].id,i.listaSuperintendencias(i.form.mina,!1)})},i.listaSuperintendencias=function(o){a.getXMinaId(o,function(o){console.log(o),i.superintendencias=o,i.form.superintendencia=i.superintendencias[0].id})},i.listaModelos=function(){t.lista(function(o){console.log(o),i.modelos=o,i.form.modelo=i.modelos[0].id})},"/equipos"==e.$$url&&(console.log("Cargando lista de equipos"),i.listaEquipos(),i.listaMinas()),"/equipo/nuevo"==e.$$url&&(console.log("Cargando lista de equipos"),i.listaMinas(),i.listaModelos())}]),angular.module("app.admin").controller("EquiposEditCtrl",["$scope","$state","$stateParams","MensajeService","EquipoFactory","SuperintendenciaFactory","ModeloFactory","MinaFactory",function(i,o,e,n,s,a,t,r){var l=e.id;i.form={},s.getXId(l,function(o){console.log("getXId",o),i.form=o,i.form.mina=o.superintendencia.mina.id,i.form.superintendencia=o.superintendencia.id,i.form.modelo=o.modelo.id,i.form.diasOptimo=o.diasOptimo,i.form.diasCritico=o.diasCritico,i.listaMinas(),i.listaModelos()}),i.editarEquipo=function(){var o={id:i.form.id,nombre:i.form.nombre,superintendencia:{id:i.form.superintendencia},modelo:{id:i.form.modelo},diasOptimo:i.form.diasOptimo,diasCritico:i.form.diasCritico};console.log(o),s.editar(o,function(i){"equipo-existe"==i.respuesta?n.showInfoMessage("El equipo ingresado ya existe."):"actualizacion-exitosa"==i.respuesta&&(window.history.back(),n.showInfoMessage("Equipo actualizado exitósamente"))})},i.listaMinas=function(){r.lista(function(o){console.log("minas",o),i.minas=o,i.listaSuperintendencias(i.form.mina)})},i.listaSuperintendencias=function(o,e){a.getXMinaId(o,function(o){console.log("superintendencias",o),i.superintendencias=o,e&&(i.form.superintendencia=i.superintendencias[0].id)})},i.listaModelos=function(){t.lista(function(o){console.log("modelos",o),i.modelos=o})}}]);
"use strict";angular.module("app.admin").controller("mostrarSeccionCtrl",["$scope","MensajeService","$uibModalInstance","datos",function(o,e,n,i){o.seccion=i.seccion,o.cancel=function(){n.dismiss("cancel")}}]),angular.module("app.admin").controller("FormatosCtrl",["$scope","$state","$location","MensajeService","ModeloFactory","MinaFactory","FormatoFactory","SeccionFactory","$uibModal","APP_CONSTANT",function(o,e,n,i,s,c,a,r,t,l){function m(){o.form.secciones=[];for(var e=0;e<o.seccionesFur.length;e++){var n=o.seccionesFur[e];o.form.secciones.push({id:n.id,orden:e+1})}}o.form={},o.seccionesFur=[],o.mdlVerSeccion=function(o){t.open({animation:!0,templateUrl:"htmlMostrarSeccion.html",controller:"mostrarSeccionCtrl",resolve:{datos:function(){return{seccion:o}}}})},o.registrarFormato=function(){m(),o.form.modelo={id:o.form.modelo},o.form.mina={id:o.form.mina},console.log(o.form),a.registrar(o.form,function(o){console.log(o),void 0==o.respuesta?(window.history.back(),i.showInfoMessage("Formato registrado exitósamente")):"fur-existe"==o.respuesta&&i.showInfoMessage("El nombre del formato ya existe")})},o.agregarSeccionAFur=function(e){for(var n=!1,i=0;i<o.seccionesFur.length;i++){var s=o.seccionesFur[i];if(s.id==e.id){n=!0;var c=confirm("La sección ya se encuentra en el formato. ¿Desea agregarla de todas maneras?");1==c&&o.seccionesFur.push(e);break}}n||o.seccionesFur.push(e)},o.removerSeccion=function(e){console.log(e);var n=confirm("¿Desea quitar esta sección del formato?");1==n&&o.seccionesFur.splice(e,1)},o.eliminarFormato=function(e){var n=window.confirm("¿Seguro que desea eliminar este formato?");n&&a.eliminar(e,function(e){"eliminacion-exitosa"==e.respuesta?(i.showInfoMessage("Formato de reporte eliminado exitósamente."),o.listaFormatos()):"fur-no-existe"==e.respuesta&&i.showInfoMessage("Este formato de reporte no existe.")})},o.listaFormatos=function(){a.lista(function(e){console.log(e),o.lista=e})},o.listaModelos=function(){s.lista(function(e){console.log(e),o.modelos=e,o.form.modelo=o.modelos[0].id,o.listaSecciones()})},o.listaSecciones=function(){r.getXModelo(o.form.modelo,function(e){console.log(e),o.secciones=e})},o.listaTiposInspeccion=function(){o.tiposInspeccion=l.tiposInspeccion,o.form.tipoInspeccion=o.tiposInspeccion[0].id},o.listaMinas=function(){c.lista(function(e){console.log(e),o.minas=e,o.form.mina=o.minas[0].id})},"/formatos"==n.$$url&&(console.log("Cargando lista de modelos"),o.listaFormatos()),"/formato/nuevo"==n.$$url&&(console.log("Cargando lista de categorias"),o.listaModelos(),o.listaMinas(),o.listaTiposInspeccion())}]),angular.module("app.admin").controller("FormatosEditCtrl",["$scope","$state","$stateParams","MensajeService","FormatoFactory","ModeloFactory","SeccionFactory","MinaFactory","$uibModal","APP_CONSTANT",function(o,e,n,i,s,c,a,r,t,l){function m(){for(var e=[],n=0;n<o.form.secciones.length;n++){var i=o.form.secciones[n];e.push({id:i.id,orden:n+1})}return e}var f=n.id;o.secciones=[],o.form={},o.listaModelos=function(){c.lista(function(e){console.log(e),o.modelos=e})},o.listaSecciones=function(){a.getXModelo(o.form.modelo,function(e){console.log(e),o.secciones=e})},o.listaMinas=function(){r.lista(function(e){console.log(e),o.minas=e})},o.listaTiposInspeccion=function(){o.tiposInspeccion=l.tiposInspeccion},o.listaModelos(),o.listaMinas(),o.listaTiposInspeccion(),s.getXId(f,function(e){console.log(e),o.form=e,o.form.modelo=e.modelo.id,o.form.mina=e.mina.id,o.listaSecciones()}),o.editarFormato=function(){var e={id:o.form.id,nombre:o.form.nombre,modelo:{id:o.form.modelo},mina:{id:o.form.mina},tipoInspeccion:o.form.tipoInspeccion,secciones:m()};s.editar(e,function(o){"actualizacion-exitosa"==o.respuesta&&(window.history.back(),i.showInfoMessage("Formato actualizado exitósamente"))})},o.mdlVerSeccion=function(o){t.open({animation:!0,templateUrl:"htmlMostrarSeccion.html",controller:"mostrarSeccionCtrl",resolve:{datos:function(){return{seccion:o}}}})},o.removerSeccion=function(e){console.log(e);var n=confirm("¿Desea quitar esta sección del formato?");1==n&&o.form.secciones.splice(e,1)},o.agregarSeccionAFur=function(e){console.log("Seccion seleccionada",JSON.stringify(e));for(var n=!1,i=0;i<o.form.secciones.length;i++){var s=o.form.secciones[i];if(s.id==e.id){n=!0;var c=confirm("La sección ya se encuentra en el formato. ¿Desea agregarla de todas maneras?");1==c&&o.form.secciones.push(e);break}}n||o.form.secciones.push(e)}}]);
"use strict";angular.module("app.admin").controller("MantenimientoCorrectivoCtrl",["$scope","$state","$location","MensajeService","CategoriaFactory","MinaFactory","EquipoFactory","InspeccionFactory","APP_CONSTANT","$q","$http","$localStorage",function(o,i,a,t,e,r,n,s,c,g,m,u){o.form={},o.form.tipoSeguimiento=c.tiposInspeccion[2].id,o.dataForm=void 0,o.listaCategorias=function(){e.lista(function(i){console.log(i),o.categorias=i,o.form.categorias=o.categorias[0].id})},o.listaMinas=function(){r.lista(function(i){console.log(i),o.minas=i,o.form.mina=o.minas[0].id})},"/seguimiento-mantenimiento-correctivo"==a.$$url&&(o.tipoUsuario=u.user.usuario_tipo,o.form.mina=u.user.mina_id,o.listaCategorias(),"CLI"!=o.tipoUsuario&&o.listaMinas()),o.obtenerGrafico=function(){for(var i=[],a=0;a<o.categorias.length;a++)o.categorias[a].checked&&i.push(o.categorias[a].id);i.length>0?(o.dataForm={minaId:o.form.mina,categorias:i,tipoSeguimiento:o.form.tipoSeguimiento},n.getMantenimientoCorrectivo(o.dataForm,function(i){o.seguimientos=i,0==o.seguimientos&&t.showInfoMessage("No se encontraron resultados")})):t.showInfoMessage("Elija una opción de categoría de equipos")},o.descargarExcel=function(){s.descargarExcelCorrectivo(o.dataForm)},o.descargarHistorial=function(){s.descargarHistorialCorrectivo()}}]);
"use strict";angular.module("app.admin").controller("MantenimientoPreventivoCtrl",["$scope","$state","$location","MensajeService","CategoriaFactory","MinaFactory","EquipoFactory","APP_CONSTANT","InspeccionFactory","$localStorage",function(o,i,e,a,n,t,s,c,r,u){o.form={},o.dataForm=void 0,o.tipoUsuario=u.user.usuario_tipo,o.form.mina=u.user.mina_id,o.listaTipoInspeccion=function(){o.tiposInspeccion=[],o.tiposInspeccion.push(c.tiposInspeccion[0]),o.tiposInspeccion.push(c.tiposInspeccion[3]),o.form.tipoSeguimiento=o.tiposInspeccion[0].id},o.listaCategorias=function(){n.lista(function(i){console.log(i),o.categorias=i,o.form.categorias=o.categorias[0].id})},o.listaMinas=function(){t.lista(function(i){console.log(i),o.minas=i,o.form.mina=o.minas[0].id})},"/seguimiento-mantenimiento-preventivo"==e.$$url&&(o.listaTipoInspeccion(),o.listaCategorias(),"CLI"!=o.tipoUsuario&&o.listaMinas()),o.obtenerGrafico=function(){for(var i=[],e=0;e<o.categorias.length;e++)o.categorias[e].checked&&i.push(o.categorias[e].id);i.length>0?(o.dataForm={minaId:o.form.mina,categorias:i,tipoSeguimiento:o.form.tipoSeguimiento},console.log("data seguimiento",o.dataForm),s.getSeguimiento(o.dataForm,function(i){o.seguimientos=i,0==o.seguimientos.length&&a.showInfoMessage("No se encontraron resultados")})):a.showInfoMessage("Elija una opción de categoría de equipos")},o.descargarExcel=function(){r.descargarExcelPreventivo(o.dataForm)}}]);
"use strict";angular.module("app.admin").controller("CollapseDemoCtrl",["$scope",function(t){t.isCollapsed=!0}]),angular.module("app.admin").controller("MasterCtrl",["$scope","$cookieStore","$state","$localStorage","$auth",function(t,e,o,n,g){var l=992;t.getWidth=function(){return window.innerWidth},t.$watch(t.getWidth,function(o,n){o>=l?angular.isDefined(e.get("toggle"))?t.toggle=!!e.get("toggle"):t.toggle=!0:t.toggle=!1}),t.toggleSidebar=function(){t.toggle=!t.toggle,e.put("toggle",t.toggle)},window.onresize=function(){t.$apply()},t.user=n.user,t.menu=JSON.parse(t.user.menu),t.logout=function(){g.isAuthenticated()&&g.logout().then(function(){console.log("logout"),n.$reset(),o.go("auth.login")})}}]);
"use strict";angular.module("app.admin").controller("MinasCtrl",["$scope","$state","$location","MensajeService","MinaFactory",function(a,e,n,i,o){a.form={},a.registrarMina=function(){console.log(JSON.stringify(a.form)),o.registrar(a.form,function(a){console.log(a),void 0==a.respuesta?(window.history.back(),i.showInfoMessage("Mina registrada exitósamente")):"mina-existe"==a.respuesta&&i.showInfoMessage("Ya existe una mina con el mismo nombre.")})},a.nuevoLogo=function(e,n){a.form.logo=n.base64},a.eliminarMina=function(e){var n=window.confirm("¿Seguro que desea eliminar esta mina?");n&&o.eliminar(e,function(e){"eliminacion-exitosa"==e.respuesta?(i.showInfoMessage("Mina eliminada exitósamente."),a.listaMinas()):"mina-en-uso"==e.respuesta?i.showInfoMessage("Esta mina tiene superintendencias asociadas. Por lo tanto, no es posible eliminarla."):"mina-no-existe"==e.respuesta&&i.showInfoMessage("Esta mina no existe.")})},a.listaMinas=function(){o.lista(function(e){a.lista=e})},"/minas"==n.$$url&&(console.log("Cargando lista de minas"),a.listaMinas())}]),angular.module("app.admin").controller("MinasEditCtrl",["$scope","$state","$stateParams","MensajeService","MinaFactory",function(a,e,n,i,o){var s=n.id;a.form={},o.getXId(s,function(e){console.log(e),a.form=e}),a.editarMina=function(){console.log(a.form),o.editar(a.form,function(a){"mina-existe"==a.respuesta?i.showInfoMessage("La mina ingresada ya existe."):"actualizacion-exitosa"==a.respuesta&&(window.history.back(),i.showInfoMessage("Mina actualizada exitósamente"))})},a.nuevoLogo=function(e,n){a.form.logo=n.base64}}]);
"use strict";angular.module("app.admin").controller("ModelosCtrl",["$scope","$state","$location","MensajeService","ModeloFactory","CategoriaFactory",function(o,e,a,s,i,t){o.form={},o.registrarModelo=function(){o.form.categoria={id:o.form.categoria},console.log(o.form),i.registrar(o.form,function(o){console.log(o),void 0==o.respuesta?(window.history.back(),s.showInfoMessage("Modelo registrado exitósamente")):"modelo-existe"==o.respuesta&&s.showInfoMessage("Ya existe un modelo con el mismo nombre.")})},o.eliminarModelo=function(e){var a=window.confirm("¿Seguro que desea eliminar este modelo?");a&&i.eliminar(e,function(e){"eliminacion-exitosa"==e.respuesta?(s.showInfoMessage("Modelo eliminado exitósamente"),o.listaModelos()):"modelo-en-uso"==e.respuesta?s.showInfoMessage("Este modelo tiene equipos y/o formatos de reporte asociados. Por lo tanto, no es posible eliminarlo."):"modelo-no-existe"==e.respuesta&&s.showInfoMessage("Este modelo no existe.")})},o.listaModelos=function(){i.lista(function(e){console.log(e),o.lista=e})},o.listaCategorias=function(){t.lista(function(e){console.log(e),o.categorias=e,o.form.categoria=o.categorias[0].id})},"/modelos"==a.$$url&&(console.log("Cargando lista de modelos"),o.listaModelos()),"/modelo/nuevo"==a.$$url&&(console.log("Cargando lista de categorias"),o.listaCategorias())}]),angular.module("app.admin").controller("ModelosEditCtrl",["$scope","$state","$stateParams","MensajeService","CategoriaFactory","ModeloFactory",function(o,e,a,s,i,t){var n=a.id;o.form={},o.listaCategorias=function(){i.lista(function(e){console.log(e),o.categorias=e})},t.getXId(n,function(e){console.log(e),o.form=e,o.form.categoria=e.categoria.id,o.listaCategorias()}),o.editarModelo=function(){o.form.categoria={id:o.form.categoria},console.log(o.form),t.editar(o.form,function(o){"modelo-existe"==o.respuesta?s.showInfoMessage("El modelo ingresado ya existe."):"actualizacion-exitosa"==o.respuesta&&(window.history.back(),s.showInfoMessage("Cliente actualizado exitósamente"))})}}]);
"use strict";angular.module("app.admin").controller("MonitoreoTemperaturaCtrl",["$scope","$state","$location","MensajeService","CategoriaFactory","MinaFactory","EquipoFactory","InspeccionFactory","APP_CONSTANT","$localStorage",function(o,e,i,a,t,n,r,s,c,u){o.form={},o.form.tipoSeguimiento=c.tiposInspeccion[1].id,o.tipoUsuario=u.user.usuario_tipo,o.form.mina=u.user.mina_id,o.listaCategorias=function(){t.lista(function(e){console.log(e),o.categorias=e,o.form.categorias=o.categorias[0].id})},o.listaMinas=function(){n.lista(function(e){console.log(e),o.minas=e,o.form.mina=o.minas[0].id})},"/seguimiento-monitoreo-temperatura"==i.$$url&&(o.listaCategorias(),"CLI"!=o.tipoUsuario&&o.listaMinas()),o.obtenerGrafico=function(){for(var e=[],i=0;i<o.categorias.length;i++)o.categorias[i].checked&&e.push(o.categorias[i].id);if(e.length>0){var t={minaId:o.form.mina,categorias:e,tipoSeguimiento:o.form.tipoSeguimiento};console.log("data seguimiento",t),r.getMonitoreoTemperatura(t,function(e){0==e.length&&a.showInfoMessage("No se encontraron resultados"),o.seguimientos=e,console.log(o.seguimientos)})}else a.showInfoMessage("Elija una opción de categoría de equipos")},o.generarExcel=function(o){s.generarExcelTemperatura(o)}}]);
"use strict";angular.module("app.admin").controller("PrincipalCtrl",["$scope","$localStorage","InspeccionFactory","CategoriaFactory","EquipoFactory","MensajeService","MinaFactory",function(a,s,i,o,e,t,c){a.user=s.user,a.tipoUsuario=a.user.usuario_tipo,console.log("TIPO DE USUARIO",a.tipoUsuario),a.form={},a.listaMinas=function(){c.lista(function(s){console.log(s),a.minas=s,a.form.mina=a.minas[0].id,a.getEstadistica()})},a.listaCategorias=function(){o.lista(function(s){a.categorias=s})},a.mostrarEstadisticaSCLDias=function(){for(var s=[],i=0;i<a.categorias.length;i++)a.categorias[i].checked&&s.push(a.categorias[i].id);s.length>0?(a.dataForm={categorias:s,minaId:a.form.mina},console.log("data reporte ::: ",a.dataForm),e.getEstadisticaCliDias(a.dataForm,function(s){a.seguimientos=s,a.labels_dias=s.labels,a.colors_dias=["#0049FF"],a.data_dias=s.dias,0==a.seguimientos.length&&t.showInfoMessage("No se encontraron resultados")})):t.showInfoMessage("Elija una opción de categoría de equipos")},a.getEstadistica=function(){var s={minaId:a.form.mina};i.getEstadisticaCliInsScl(s,function(s){a.labels_scl=s.meses,a.colors_scl=[];for(var i=0;i<12;i++)a.colors_scl.push("#0049FF");a.data_scl=s.inspecciones}),i.getEstadisticaCliInsMc(s,function(s){a.labels_co=s.meses,a.series_co=s.series,a.colors_co=["#0049FF","#FF0000"],a.data_co=[s.inspecciones_abiertas,s.inspecciones_cerradas]})},a.listaMinas(),a.listaCategorias()}]);
"use strict";angular.module("app.admin").controller("SeccionesCtrl",["$scope","$state","$location","MensajeService","SeccionFactory","ComponentesFactory","ModeloFactory",function(o,e,n,c,t,a,s){o.componentes=[],o.seccion={},o.filas=5,o.columnas=4,o.seleccinados=[],o.reporteTemperatura=!1,o.registrarSeccion=function(){var e={nombre:o.nombre,reporteTemperatura:o.reporteTemperatura,tipo:"CU",contenido:{data:o.seccion},modelo:{id:o.modelo}};void 0!=o.imagenAyuda&&(e.imagenAyuda=o.imagenAyuda),console.log(e),t.registrar(e,function(o){console.log(o),void 0==o.respuesta&&(window.history.back(),c.showInfoMessage("Sección registrada exitósamente"))})},o.nuevaImagen=function(e,n){o.imagenAyuda=n.base64},o.eliminarSeccion=function(e){var n=window.confirm("¿Seguro que desea eliminar esta sección?");n&&t.eliminar(e,function(e){"eliminacion-exitosa"==e.respuesta?(c.showInfoMessage("Sección eliminada exitósamente"),o.listaSecciones()):"seccion-en-uso"==e.respuesta?c.showInfoMessage("Esta sección tiene formatos de reporte asociados. Por lo tanto, no es posible eliminarla."):"seccion-no-existe"==e.respuesta&&c.showInfoMessage("Esta sección no existe.")})},o.listaSecciones=function(){t.lista(function(e){console.log(e),o.lista=e})},o.listaModelos=function(){s.lista(function(e){console.log(e),o.modelos=e,o.modelo=o.modelos[0].id})},o.listaComponentes=function(){a.lista(function(e){console.log(e),o.componentes=e})},"/secciones"==n.$$url&&(console.log("Cargando lista de secciones"),o.listaSecciones()),"/secciones/nuevo"==n.$$url&&(console.log("Nueva seccion"),o.listaComponentes(),o.listaModelos()),o.generarTabla=function(){console.log("Generando tablas");var e={obj:"table",content:[],pictures:[]};o.seccion=e;for(var n=0;n<o.filas;n++){var c={obj:"row",content:[]};o.seccion.content.push(c);for(var t=0;t<o.columnas;t++){var a={obj:"column",selected:!1,content:{}};o.seccion.content[n].content.push(a)}}},o.agregarFila=function(){var e={obj:"row",content:[]};o.seccion.content.push(e);for(var n=0;n<o.columnas;n++){var c={obj:"column",selected:!1,content:{}};o.seccion.content[o.filas].content.push(c)}o.filas++},o.agregarColumna=function(){for(var e=0;e<o.filas;e++){var n={obj:"column",selected:!1,content:{}};o.seccion.content[e].content.push(n)}o.columnas++},o.eliminarFila=function(){o.filas>=2&&(o.filas--,o.seccion.content.splice(o.filas,1))},o.eliminarColumna=function(){if(o.columnas>=2){o.columnas--;for(var e=0;e<o.filas;e++)o.seccion.content[e].content.splice(o.columnas,1)}},o.guardarConfiguracion=function(e,n){switch(console.log(e),o.componentes[n].contenido.data.obj){case"input-option":var c={value:e};o.componentes[n].contenido.data.options.push(c),o.componentes[n].contenido.data.value=o.componentes[n].contenido.data.options[0].value;break;default:console.log("Raro")}},o.removerItemOption=function(e,n){o.componentes[e].contenido.data.options.splice(n,1),0==o.componentes[e].contenido.data.options.length&&(o.componentes[e].contenido.data.value="")},o.onDropT=function(e,n,c,t){var a=!0;"input-option"==n.contenido.data.obj&&0==n.contenido.data.options.length&&(a=!1,alert("Debe agregar opciones a este componente")),a&&(o.seccion.content[c].content[t].content=n.contenido.data)},o.agregarASeleccion=function(e,n){if(o.seccion.content[e].content[n].content.hasOwnProperty("obj")){for(var c=!1,t=-1,a=0;a<o.seleccinados.length;a++){var s=o.seleccinados[a];if(s.row==e&&s.col==n){c=!0,t=a;break}}c?t>=0&&(o.seccion.content[e].content[n].selected=!1,o.seleccinados.splice(t,1)):(o.seccion.content[e].content[n].selected=!0,o.seleccinados.push({row:e,col:n}))}else console.log("la celda esta vacia")},o.eliminarSeleccionados=function(){for(var e=0;e<o.seleccinados.length;e++){var n=o.seleccinados[e];o.seccion.content[n.row].content[n.col].selected=!1,o.seccion.content[n.row].content[n.col].content={}}o.seleccinados=[]}}]),angular.module("app.admin").controller("SeccionesEditCtrl",["$scope","$state","$stateParams","MensajeService","SeccionFactory","ComponentesFactory","ModeloFactory",function(o,e,n,c,t,a,s){var i=n.id;t.getXId(i,function(e){o.nombre=e.nombre,o.seccion=e.contenido.data,o.imagenAyuda=e.imagenAyuda,o.reporteTemperatura=e.reporteTemperatura,o.modelo=e.modelo.id}),o.componentes=[],o.seleccinados=[],o.listaComponentes=function(){a.lista(function(e){console.log(e),o.componentes=e})},o.listaModelos=function(){s.lista(function(e){console.log(e),o.modelos=e})},o.listaComponentes(),o.listaModelos(),o.actualizarSeccion=function(){var e={id:i,nombre:o.nombre,contenido:{data:o.seccion},reporteTemperatura:o.reporteTemperatura,modelo:{id:o.modelo}};void 0!=o.imagenAyuda&&(e.imagenAyuda=o.imagenAyuda),t.editar(e,function(o){"actualizacion-exitosa"==o.respuesta&&(window.history.back(),c.showInfoMessage("Seccion actualizada exitósamente"))})},o.nuevaImagen=function(e,n){o.imagenAyuda=n.base64},o.guardarConfiguracion=function(e,n){switch(console.log(e),o.componentes[n].contenido.data.obj){case"input-option":var c={value:e};o.componentes[n].contenido.data.options.push(c),o.componentes[n].contenido.data.value=o.componentes[n].contenido.data.options[0].value;break;default:console.log("Raro")}},o.removerItemOption=function(e,n){console.log(e+" - "+n),o.componentes[e].contenido.data.options.splice(n,1),0==o.componentes[e].contenido.data.options.length&&(o.componentes[e].contenido.data.value="")},o.onDropT=function(e,n,c,t){o.seccion.content[c].content[t].content=n.contenido.data},o.agregarASeleccion=function(e,n){if(o.seccion.content[e].content[n].content.hasOwnProperty("obj")){for(var c=!1,t=-1,a=0;a<o.seleccinados.length;a++){var s=o.seleccinados[a];if(s.row==e&&s.col==n){c=!0,t=a;break}}c?t>=0&&(o.seccion.content[e].content[n].selected=!1,o.seleccinados.splice(t,1)):(o.seccion.content[e].content[n].selected=!0,o.seleccinados.push({row:e,col:n}))}else console.log("la celda esta vacia")},o.eliminarSeleccionados=function(){for(var e=0;e<o.seleccinados.length;e++){var n=o.seleccinados[e];o.seccion.content[n.row].content[n.col].selected=!1,o.seccion.content[n.row].content[n.col].content={}}o.seleccinados=[]}}]);
"use strict";angular.module("app.admin").controller("SuperintendenciasCtrl",["$scope","$state","$location","MensajeService","SuperintendenciaFactory","MinaFactory",function(e,n,i,a,s,o){e.form={},e.registrarSuperintendencia=function(){e.form.mina={id:e.form.mina},console.log(e.form),s.registrar(e.form,function(e){console.log(e),void 0==e.respuesta?(window.history.back(),a.showInfoMessage("Superintendencia registrada exitósamente")):"superintendencia-existe"==e.respuesta&&a.showInfoMessage("Ya existe una superintendencia con el mismo nombre.")})},e.eliminarSuperintendencia=function(n){var i=window.confirm("¿Seguro que desea eliminar esta superintendencia?");i&&s.eliminar(n,function(n){"eliminacion-exitosa"==n.respuesta?(a.showInfoMessage("Superintendencia eliminada exitósamente."),e.listaSuperintendencias()):"superintendencia-en-uso"==n.respuesta?a.showInfoMessage("Esta superintendencia tiene equipos asociados. Por lo tanto, no es posible eliminarla."):"superintendencia-no-existe"==n.respuesta&&a.showInfoMessage("Esta superintendencia no existe.")})},e.listaSuperintendencias=function(){s.lista(function(n){console.log(n),e.lista=n})},e.listaMinas=function(){o.lista(function(n){console.log(n),e.minas=n,e.form.mina=e.minas[0].id})},"/superintendencias"==i.$$url&&(console.log("Cargando lista de superintendencias"),e.listaSuperintendencias()),"/superintendencia/nuevo"==i.$$url&&(console.log("Cargando lista de minas"),e.listaMinas())}]),angular.module("app.admin").controller("SuperintendenciasEditCtrl",["$scope","$state","$stateParams","MensajeService","SuperintendenciaFactory","MinaFactory",function(e,n,i,a,s,o){var t=i.id;e.form={},s.getXId(t,function(n){console.log(n),e.form=n,e.form.mina=n.mina.id}),e.editarSuperintendencia=function(){e.form.mina={id:e.form.mina},console.log(e.form),s.editar(e.form,function(e){"superintendencia-existe"==e.respuesta?a.showInfoMessage("La superintendencia ingresada ya existe."):"actualizacion-exitosa"==e.respuesta&&(window.history.back(),a.showInfoMessage("Superintendencia actualizada exitósamente"))})},e.listaMinas=function(){o.lista(function(n){console.log(n),e.minas=n,e.form.mina=e.minas[0].id})},e.listaMinas()}]);
"use strict";angular.module("app.admin").controller("CambiarClaveCtrl",["$scope","MensajeService","$uibModalInstance","UsuarioFactory","datos",function(o,a,s,i,e){o.usuario=e.usuario,o.ok=function(){s.close(),o.form.id=e.id,i.editar(o.form,function(s){"correo-existe"==s.respuesta?a.showInfoMessage("El correo ingresado ya está siendo usado por otro usuario."):"actualizacion-exitosa"==s.respuesta&&(o.cancel(),a.showInfoMessage("Usuario actualizado exitósamente"))})},o.cancel=function(){s.dismiss("cancel")}}]),angular.module("app.admin").controller("UsuariosCtrl",["$scope","$cookieStore","$state","$uibModal","$localStorage","$location","MensajeService","$auth","UsuarioFactory","MinaFactory","APP_CONSTANT",function(o,a,s,i,e,r,n,t,u,l,c){o.tiposUsuario=c.tiposUsuario,o.tiposUsuario.length>4&&o.tiposUsuario.splice(3,1),o.form={},o.form.tipoUsuario=c.tiposUsuario[0].id,o.mdlCambiarClave=function(o,a){i.open({animation:!0,templateUrl:"htmlCambiarClave.html",controller:"CambiarClaveCtrl",size:120,resolve:{datos:function(){return{id:o,usuario:a}}}})},o.registrarUsuario=function(){console.log(o.form),o.form.mina={id:o.form.mina},u.registrar(o.form,function(o){"registro-exitoso"==o.respuesta?(window.history.back(),n.showInfoMessage("Cliente registrado exitósamente")):"correo-existe"==o.respuesta?n.showInfoMessage("El correo ingresado ya está siendo usado por otro usuario."):"faltan-datos"==o.respuesta&&n.showInfoMessage("Faltan datos requeridos para el registro del usuario.")})},o.eliminarUsuario=function(a){var s=window.confirm("¿Seguro que desea eliminar este usuario?");s&&u.eliminar(a,function(a){"eliminacion-exitosa"==a.respuesta?(n.showInfoMessage("Usuario eliminado correctamente."),o.listaUsuarios()):"usuario-en-uso"==a.respuesta?n.showInfoMessage("Este usuario ya ha realizado inspecciones. Por lo tanto, no es posible eliminarlo."):"usuario-no-existe"==a.respuesta&&n.showInfoMessage("Este usuario no existe.")})},o.listaUsuarios=function(){u.lista(function(a){o.lista=a})},o.listaMinas=function(){l.lista(function(a){o.minas=a,o.form.mina=o.minas[0].id})},o.generarExcel=function(){u.generarExcelUsuarios()},"/usuarios"==r.$$url&&(console.log("Cargando lista de usuarios"),o.listaUsuarios()),"/usuarios/nuevo"==r.$$url&&(console.log("Cargando nuevos usuarios"),o.listaMinas())}]),angular.module("app.admin").controller("UsuariosEditCtrl",["$scope","$state","$stateParams","MensajeService","UsuarioFactory","MinaFactory","APP_CONSTANT",function(o,a,s,i,e,r,n){var t=s.id;o.tiposUsuario=n.tiposUsuario,o.form={},e.getXId(t,function(a){console.log(a),o.form=a,o.form.telefono=parseInt(a.telefono),o.form.tipoUsuario=a.tipoUsuario,o.form.mina=a.mina.id}),o.editarUsuario=function(){console.log(o.form),o.form.mina={id:o.form.mina},e.editar(o.form,function(o){"correo-existe"==o.respuesta?i.showInfoMessage("El correo ingresado ya está siendo usado por otro usuario."):"actualizacion-exitosa"==o.respuesta&&(window.history.back(),i.showInfoMessage("Cliente actualizado exitósamente"))})},o.listaMinas=function(){r.lista(function(a){o.minas=a,o.form.mina=o.minas[0].id})},o.listaMinas()}]);
"use strict";angular.module("app.admin").factory("CategoriaFactory",["$http","APP_CONSTANT",function(t,a){var n={};return n.lista=function(n){t.get(a.apiRest+"/categorias").then(function(t){n(t.data)})},n.getXId=function(n,i){t.get(a.apiRest+"/categoria/"+n).then(function(t){i(t.data)})},n.registrar=function(n,i){t.post(a.apiRest+"/categoria",n).then(function(t){i(t.data)})},n.editar=function(n,i){t.put(a.apiRest+"/categoria",n).then(function(t){i(t.data)})},n.eliminar=function(n,i){t["delete"](a.apiRest+"/categoria/"+n).then(function(t){i(t.data)})},n}]);
"use strict";angular.module("app.admin").factory("ComponentesFactory",["$http","APP_CONSTANT",function(t,n){var e={};return e.lista=function(e){t.get(n.apiRest+"/componentes").then(function(t){e(t.data)})},e.getXId=function(e,o){t.get(n.apiRest+"/componente/"+e).then(function(t){o(t.data)})},e.registrar=function(e,o){t.post(n.apiRest+"/componente",e).then(function(t){o(t.data)})},e.editar=function(e,o){t.put(n.apiRest+"/componente",e).then(function(t){o(t.data)})},e.eliminar=function(e,o){t["delete"](n.apiRest+"/componente/"+e).then(function(t){o(t.data)})},e}]);
"use strict";angular.module("app.admin").factory("EquipoFactory",["$http","APP_CONSTANT",function(t,n){var i={};return i.lista=function(i){t.get(n.apiRest+"/equipos").then(function(t){i(t.data)})},i.getXId=function(i,e){t.get(n.apiRest+"/equipo/"+i).then(function(t){e(t.data)})},i.getXMina=function(i,e){t.get(n.apiRest+"/equipos/mina/"+i).then(function(t){e(t.data)})},i.getXSuperintendencia=function(i,e){t.get(n.apiRest+"/equipos/superintendencia/"+i).then(function(t){e(t.data)})},i.registrar=function(i,e){t.post(n.apiRest+"/equipo",i).then(function(t){e(t.data)})},i.editar=function(i,e){t.put(n.apiRest+"/equipo",i).then(function(t){e(t.data)})},i.eliminar=function(i,e){t["delete"](n.apiRest+"/equipo/"+i).then(function(t){e(t.data)})},i.getSeguimiento=function(i,e){t.post(n.apiRest+"/equipos/seguimiento",i).then(function(t){e(t.data)})},i.getEstadisticaCliDias=function(i,e){t.post(n.apiRest+"/estadistica/dias",i).then(function(t){e(t.data)})},i.getMantenimientoCorrectivo=function(i,e){t.post(n.apiRest+"/equipos/mantenimiento-correctivo",i).then(function(t){e(t.data)})},i.getMonitoreoTemperatura=function(i,e){t.post(n.apiRest+"/equipos/monitoreo-temperatura",i).then(function(t){e(t.data)})},i}]);
"use strict";angular.module("app.admin").factory("FormatoFactory",["$http","APP_CONSTANT",function(t,n){var a={};return a.lista=function(a){t.get(n.apiRest+"/furs").then(function(t){a(t.data)})},a.getXId=function(a,i){t.get(n.apiRest+"/fur/"+a).then(function(t){i(t.data)})},a.registrar=function(a,i){t.post(n.apiRest+"/fur",a).then(function(t){i(t.data)})},a.editar=function(a,i){t.put(n.apiRest+"/fur",a).then(function(t){i(t.data)})},a.eliminar=function(a,i){t["delete"](n.apiRest+"/fur/"+a).then(function(t){i(t.data)})},a}]);
"use strict";angular.module("app.admin").factory("InspeccionFactory",["$http","APP_CONSTANT",function(e,t){var n={};return n.getXCategoriaEquipo=function(n,o){e.get(t.apiRest+"/inspeccion/categoria-equipo/"+n).then(function(e){o(e.data)})},n.getXModelo=function(n,o){e.get(t.apiRest+"/inspeccion/modelo/"+n).then(function(e){o(e.data)})},n.getXMina=function(n,o){e.get(t.apiRest+"/inspeccion/mina/"+n).then(function(e){o(e.data)})},n.getXTipo=function(n,o){e.get(t.apiRest+"/inspeccion/tipo/"+n).then(function(e){o(e.data)})},n.getXId=function(n,o){e.get(t.apiRest+"/inspeccion/"+n).then(function(e){o(e.data)})},n.editar=function(n,o){e.put(t.apiRest+"/inspeccion",n).then(function(e){o(e.data)})},n.getConsultaLinea=function(n,o){e.post(t.apiRest+"/inspecciones/cunsulta-linea",n).then(function(e){o(e.data)})},n.getEstadisticaCliInsScl=function(n,o){e.post(t.apiRest+"/estadistica/scl",n).then(function(e){o(e.data)})},n.getEstadisticaCliInsMc=function(n,o){e.post(t.apiRest+"/estadistica/mc",n).then(function(e){o(e.data)})},n.eliminar=function(n,o){e["delete"](t.apiRest+"/inspeccion/"+n).then(function(e){o(e.data)})},n.generarPdf=function(n){e({url:t.apiRest+"/generar-pdf/inspeccion/"+n,method:"GET",responseType:"arraybuffer"}).success(function(e,t,o,a){saveAs(new Blob([e],{type:"application/pdf"}),"inspeccion_sig"+n+".pdf")}).error(function(e,t,n,o){console.log("error al descargar pdf de inspeccion")})},n.generarExcelTemperatura=function(n){e({url:t.apiRest+"/monitoreo/descargar-excel/"+n,method:"GET",responseType:"arraybuffer"}).success(function(e,t,n,o){saveAs(new Blob([e],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),"reporte_temperatura.xls")}).error(function(e,t,n,o){console.log("error al descargar excel monitoreo equipo")})},n.descargarExcelCorrectivo=function(n){e({url:t.apiRest+"/correctivo/descargar-excel",method:"POST",data:n,headers:{"Content-type":"application/json"},responseType:"arraybuffer"}).success(function(e,t,n,o){saveAs(new Blob([e],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),"reporte_correctivo.xls")}).error(function(e,t,n,o){console.log("error al descargar excel inspecciones correctivas")})},n.descargarHistorialCorrectivo=function(){e({url:t.apiRest+"/correctivo/historial",method:"GET",responseType:"arraybuffer"}).success(function(e,t,n,o){saveAs(new Blob([e],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),"historial_correctivo.xls")}).error(function(e,t,n,o){console.log("error al descargar excel monitoreo equipo")})},n.descargarExcelPreventivo=function(n){e({url:t.apiRest+"/seguimiento/descargar-excel",method:"POST",data:n,headers:{"Content-type":"application/json"},responseType:"arraybuffer"}).success(function(e,t,n,o){saveAs(new Blob([e],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),"reporte_preventivo.xls")}).error(function(e,t,n,o){console.log("error al descargar archivo")})},n}]);
"use strict";angular.module("app.admin").factory("MinaFactory",["$http","APP_CONSTANT",function(t,n){var a={};return a.lista=function(a){t.get(n.apiRest+"/minas").then(function(t){a(t.data)})},a.getXId=function(a,i){t.get(n.apiRest+"/mina/"+a).then(function(t){i(t.data)})},a.registrar=function(a,i){t.post(n.apiRest+"/mina",a).then(function(t){i(t.data)})},a.editar=function(a,i){t.put(n.apiRest+"/mina",a).then(function(t){i(t.data)})},a.eliminar=function(a,i){t["delete"](n.apiRest+"/mina/"+a).then(function(t){i(t.data)})},a}]);
"use strict";angular.module("app.admin").factory("ModeloFactory",["$http","APP_CONSTANT",function(t,n){var a={};return a.lista=function(a){t.get(n.apiRest+"/modelos").then(function(t){a(t.data)})},a.getXId=function(a,e){t.get(n.apiRest+"/modelo/"+a).then(function(t){e(t.data)})},a.listaxCategoria=function(a,e){t.get(n.apiRest+"/modelos/categoria/"+a).then(function(t){e(t.data)})},a.registrar=function(a,e){t.post(n.apiRest+"/modelo",a).then(function(t){e(t.data)})},a.editar=function(a,e){t.put(n.apiRest+"/modelo",a).then(function(t){e(t.data)})},a.eliminar=function(a,e){t["delete"](n.apiRest+"/modelo/"+a).then(function(t){e(t.data)})},a}]);
"use strict";angular.module("app.admin").factory("SeccionFactory",["$http","APP_CONSTANT",function(t,n){var e={};return e.lista=function(e){t.get(n.apiRest+"/secciones").then(function(t){e(t.data)})},e.getXModelo=function(e,i){t.get(n.apiRest+"/secciones/modelo/"+e).then(function(t){i(t.data)})},e.getXId=function(e,i){t.get(n.apiRest+"/seccion/"+e).then(function(t){i(t.data)})},e.registrar=function(e,i){t.post(n.apiRest+"/seccion",e).then(function(t){i(t.data)})},e.editar=function(e,i){t.put(n.apiRest+"/seccion",e).then(function(t){i(t.data)})},e.eliminar=function(e,i){t["delete"](n.apiRest+"/seccion/"+e).then(function(t){i(t.data)})},e}]);
"use strict";angular.module("app.admin").factory("SuperintendenciaFactory",["$http","APP_CONSTANT",function(n,t){var e={};return e.lista=function(e){n.get(t.apiRest+"/superintendencias").then(function(n){e(n.data)})},e.getXMinaId=function(e,i){n.get(t.apiRest+"/superintendencias/mina/"+e).then(function(n){i(n.data)})},e.getXId=function(e,i){n.get(t.apiRest+"/superintendencia/"+e).then(function(n){i(n.data)})},e.registrar=function(e,i){n.post(t.apiRest+"/superintendencia",e).then(function(n){i(n.data)})},e.editar=function(e,i){n.put(t.apiRest+"/superintendencia",e).then(function(n){i(n.data)})},e.eliminar=function(e,i){n["delete"](t.apiRest+"/superintendencia/"+e).then(function(n){i(n.data)})},e}]);
"use strict";angular.module("app.admin").factory("UsuarioFactory",["$http","APP_CONSTANT",function(t,e){var a={};return a.lista=function(a){t.get(e.apiRest+"/usuarios").then(function(t){a(t.data)})},a.registrar=function(a,n){t.post(e.apiRest+"/usuario",a).then(function(t){n(t.data)})},a.getXId=function(a,n){t.get(e.apiRest+"/usuario/"+a).then(function(t){n(t.data)})},a.editar=function(a,n){t.put(e.apiRest+"/usuario",a).then(function(t){n(t.data)})},a.eliminar=function(a,n){t["delete"](e.apiRest+"/usuario/"+a).then(function(t){n(t.data)})},a.generarExcelUsuarios=function(){t({url:e.apiRest+"/usuarios/descargar-excel",method:"GET",responseType:"arraybuffer"}).success(function(t,e,a,n){saveAs(new Blob([t],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),"usuarios.xls")}).error(function(t,e,a,n){console.log("error al descargar excel usuarios")})},a}]);
"use strict";angular.module("app.admin").service("MensajeService",function(){this.showInfoMessage=function(e){var s=document.getElementById("caja-mensajes-sistema");s.innerHTML="<label class='lbl-caja-mensajes-sistema'>"+e+"</label>",s.style.display="block",setTimeout(function(){var e=document.getElementById("caja-mensajes-sistema");e.innerHTML="",e.style.display="none"},3e3)}});
"use strict";angular.module("app.auth").controller("AuthCtrl",["$scope","$state","$http","$localStorage","$auth",function(a,o,r,e,t){a.user={},a.login=function(r){void 0!=a.user.usuario&&void 0!=a.user.clave&&""!=a.user.usuario&&""!=a.user.clave?t.login(a.user).then(function(a){"login-exitoso"==a.data.respuesta?(e.user=a.data,o.go("admin.principal",a.data,{params:a.data,navDirection:"forward"})):"usuario-no-existe"==a.data.respuesta?(alert("Usuario no registrado"),console.log("Error : "+a.data.respuesta)):"pass-no-coincide"==a.data.respuesta&&(alert("Clave incorrecta"),console.log("Error : "+a.data.respuesta))})["catch"](function(a){console.log("Error")}):console.log("campos vacios")}}]);
"use strict";angular.module("app.admin").directive("backButton",["$window",function(i){return{restrict:"A",link:function(n,t,c){t.bind("click",function(){i.history.back()})}}}]);
"use strict";function rdLoading(){var d={restrict:"AE",template:'<div class="loading"><div class="double-bounce1"></div><div class="double-bounce2"></div></div>'};return d}angular.module("app.common").directive("rdLoading",rdLoading);
"use strict";angular.module("app.common").directive("myEnter",function(){return function(n,e,t){e.bind("keydown keypress",function(e){13===e.which&&(n.$apply(function(){n.$eval(t.myEnter)}),e.preventDefault())})}});
"use strict";function rdWidgetBody(){var d={requires:"^rdWidget",scope:{loading:"@?",classes:"@?"},transclude:!0,template:'<div class="widget-body" ng-class="classes"><rd-loading ng-show="loading"></rd-loading><div ng-hide="loading" class="widget-content" ng-transclude></div></div>',restrict:"E"};return d}angular.module("app.common").directive("rdWidgetBody",rdWidgetBody);
"use strict";function rdWidgetFooter(){var e={requires:"^rdWidget",transclude:!0,template:'<div class="widget-footer" ng-transclude></div>',restrict:"E"};return e}angular.module("app.common").directive("rdWidgetFooter",rdWidgetFooter);
"use strict";function rdWidgetTitle(){var i={requires:"^rdWidget",scope:{title:"@",icon:"@"},transclude:!0,template:'<div class="widget-header"><div class="row"><div class="pull-left"><i class="fa" ng-class="icon"></i> {{title}} </div><div class="pull-right col-xs-6 col-sm-4" ng-transclude></div></div></div>',restrict:"E"};return i}angular.module("app.common").directive("rdWidgetHeader",rdWidgetTitle);
"use strict";function rdWidget(){var t={transclude:!0,template:'<div class="widget" ng-transclude></div>',restrict:"EA"};return t}angular.module("app.common").directive("rdWidget",rdWidget);